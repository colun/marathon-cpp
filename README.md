自動採点テンプレート in クラウド for マラソンマッチ (C++版)
==================================================

本自動採点システムは、他のシステムとの共存が可能な様には作られていません。

まっさらなサーバーをクラウド上に借りるなどして、マラソンマッチ中だけ使い倒すのが正しい使い方です。

CentOS(64bit)を前提に作られていますが、他のOSでも変更は必要かもしれないですが、動く可能性があります。

（64bit特有のことをしているわけではなく、単にテスト用に使っているのが64bitというだけの話です）

**※※※このプロジェクトは、まだ作りかけです。※※※**

**※※※近日中に検証なども行い、使える状態まで持っていくつもりなので、もうしばらくお待ち下さい。※※※**

ライセンスは現在の所付けてません（考え中）が、ローカルでしか使わないツールですし、コンテストにサブミットするものとは違うので、付けなくても誰も困らないだろうなぁと。。。

Java版、C#版、Python版などを作って公開する場合は、たぶんライセンスの問題が出てくる気がするので、ライセンスを付ける様に急かしてください。（Twitter上のcolunまで！）

導入
----

このプロジェクトを、プライベートなgitリポジトリとしてどこかに複製して使ってください。

（svnリポジトリとして複製した場合は、bin/cron_evalなどにある"git pull"を"svn update ."に変更する等の修正が必要です）

次に、evalフォルダのeval.cppを、問題に合ったものに変更してください。
（hpp側にmainまで全部書いてしまう派の方は、cpp側にはインクルードのみで良いと思います。私はmainはcpp側に、そして送信する内容をhpp側に書く派です）

また、evalフォルダにeval.jarを置いてください。
（公式jarのファイル名を変更したものでokな場合がほとんど。うまく行かない場合は、bin/exec_evalのexec周りを変えてみるなどしてみてください）

採点させる時には、evalフォルダ内に.hppファイルを置いてください。evalフォルダ内に置いたhppファイルは、採点時にtmpフォルダ下のユニーク名で作られたフォルダにeval.hppとして名前変更してコピーされ、eval.cpp経由で呼び出されてコンパイルされ、eval.jar経由で実行されます。

Score = ****

Time = ****

の様に出力されたもの（行頭から始まってる必要あり）が、スコアやタイムとして認識されて、記録されます。

.hppファイルは、hoge.hppとかfuga.hppなど、拡張子がhppになっていれば、認識してくれます。
また、サブフォルダも自動的に認識します。

000-hogeや001-fugaの様に、調査番号の後に調査内容のラベルみたいなものを短く付けたフォルダを用意して、その中にx0.7.hppとかx1.0.hppとかx2.0.hppなどの様に、パラメータ名をファイル名としたものを並べるのが推奨されます。

これらのファイルを置き換えたものを、gitリポジトリやsvnリポジトリにコミットしておき、次の項目で用意するサーバーから自動アップデートさせながら自動採点を行っていくことになります。

サーバーへのインストール
-------------------

まっさらなOS（CentOS6 64bit推奨）に対して、root権限にて、以下のコマンドでインストールする。

yum install git -y

git clone git://【あなたのgitリポジトリ】.git .

./install

（いっそ、この目的にしか使わないサーバーになるので、rootのrootフォルダに入れてしまうのが便利かも）

自動採点cronの設定
---------------

**※cron設定を上書きします。**

**※既に何らかのシステムで使っているサーバー上では行わないでください。**

./bin/install_cron

自動採点cronの設定解除
------------------

**※cron設定を上書きします。**

**※既に何らかのシステムで使っているサーバー上では行わないでください。**

./bin/uninstall_cron

統計結果の確認
-----------

./report

なお、ここでリポートされる順番は、priorityテーブルのpriority値順になります。

priorityテーブルは、nameとpriority値の２つのフィールドのみを持つテーブルです。
並び順を変更したい場合は、ここを手作業で書き換えると良いと思います。
（すみません、ここの部分って使いづらかったので、どうにかバージョン管理側で編集可能な方法をそのうち考えます……が、たぶん実戦でしかバージョンアップしていかないので、来年になるかもしれません）

MySQLテーブルについて
-----------------

topcoderというデータベースが自動的に作られて、その中にevalというテーブルとpriorityというテーブルが作られます。

